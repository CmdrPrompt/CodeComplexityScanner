<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cyclomatic Complexity ‚Äì Report</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        table { border-collapse: collapse; width: 95%; margin-bottom: 40px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; }
        h1, h2, h3 { color: #333; }
    </style>
</head>
<body>
    <h1>Cyclomatic Complexity ‚Äì Project Analysis</h1>
    <p>
        üß† <strong>General threshold:</strong> Complexity above <strong>{{ threshold }}</strong> for a folder/root may indicate a need for refactoring.<br>
        üóÇÔ∏è <strong>File threshold:</strong> Individual files with complexity above <strong>{{ problem_roots[0].problem_files[0].complexity if problem_roots and problem_roots[0].problem_files else 'N/A' }}</strong> (set via <code>--problem-file-threshold</code>) are highlighted in the summary below.
    </p>

    {% if problem_roots %}
    <h2>üö® Summary: Root folders exceeding threshold ({{ threshold }})</h2>
    <table>
        <tr>
            <th>Language</th>
            <th>Folder</th>
            <th>Average Complexity</th>
            <th>Rating</th>
            <th>Problematic Files</th>
        </tr>
        {% for item in problem_roots %}
        <tr>
            <td>{{ item.language }}</td>
            <td>{{ item.root }}</td>
            <td>{{ item.average | round(1) }}</td>
            <td>{{ item.grade }}</td>
            <td>
                {% if item.problem_files and item.problem_files|length > 0 %}
                <ul>
                    {% for f in item.problem_files %}
                    <li>{{ f.path }} ({{ f.complexity }})</li>
                    {% endfor %}
                </ul>
                {% else %}
                <em>None</em>
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </table>
    {% endif %}

    {% for lang in languages %}
        <h2>Language: {{ lang.name }}</h2>
        {% for root in lang.roots %}
            <h3>Folder: {{ root.path }}</h3>
            <p><strong>Average complexity:</strong> {{ root.average.formatted }}</p>
            <table>
                <tr>
                    <th>Path</th>
                    <th>Function Count</th>
                    <th>Complexity</th>
                    <th>Rating</th>
                </tr>
                {% for f in root.files %}
                    <tr>
                        <td>{{ f.path }}</td>
                        <td>{{ f.functions }}</td>
                        <td>{{ f.complexity }}</td>
                        <td>{{ f.grade }}</td>
                    </tr>
                {% endfor %}
            </table>
        {% endfor %}
    {% endfor %}


    <hr>
    <section>
        <h2>Usage</h2>
        <p>
            <strong>Command line parameters:</strong><br>
            <code>python main.py &lt;directories&gt; --threshold &lt;value&gt; --problem-file-threshold &lt;value&gt;</code>
        </p>
        <ul>
            <li><code>&lt;directories&gt;</code>: One or more root folders to scan for code complexity.</li>
            <li><code>--threshold</code>: Sets the threshold for average folder/root complexity. Folders above this value are highlighted in the summary.</li>
            <li><code>--problem-file-threshold</code>: Sets the threshold for individual file complexity. Files above this value are listed under each problematic folder in the summary.</li>
        </ul>
        <p>
            Example:<br>
            <code>python main.py src test --threshold 20 --problem-file-threshold 15</code>
        </p>
    </section>
</body>
</html>
